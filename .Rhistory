write.csv(koubai.address, "aa.csv")
koubai.address %>% class()
suppressMessages(library(tidyverse))
koubai.address %>% class()
koubai.address %>% class
koubai.address[1]
koubai.address <- getURL(
"https://raw.githubusercontent.com/luka3117/kagome/master/total.csv"
)
koubai.address %>% class()
koubai.address <- getURL(
"https://raw.githubusercontent.com/luka3117/kagome/master/total.csv"
)
library(RCurl)
koubai.address <- getURL(
"https://raw.githubusercontent.com/luka3117/kagome/master/total.csv"
)
koubai.address %>% class()
koubai.address %>% length()
koubai<-read.csv(text = koubai.address) %>% tbl_df()
koubai
koubai<-read.csv(text = koubai.address) %>% tbl_df()
koubai
koubai %>% dim()
koubai %>% colnames()
koubai<-read.csv(text = koubai.address, row.names = F) %>% tbl_df()
koubai<-read.csv(text = koubai.address, row.names = 1) %>% tbl_df()
koubai
koubai %>% dim()
koubai %>% colnames()
koubai %>% summary()
plot(koubai)
plot(koubai)
suppressMessages(library(readxl))
suppressMessages(library(dplyr))
suppressMessages(library(tidyverse))
dir(pattern = "ranking")
filename.list <- dir(pattern = "ranking")[-c(7)]
filename.list
filename.list
sex.age.variable<-gsub("トマト調味料アイテムランキング","",filename.list) %>%
gsub("_ranking2_","",.) %>%
gsub("xls","",.) %>%
gsub("\\d{7}","",.) %>%
gsub("\\(|\\)","",.) %>%
gsub("\\.","",.) %>%
gsub("性","性.",.) %>% data.frame(a=.)
sex.age.variable
gsub("トマト調味料アイテムランキング","",filename.list) %>%
gsub("_ranking2_","",.) %>%
gsub("xls","",.) %>%
gsub("\\d{7}","",.) %>%
gsub("\\(|\\)","",.) %>%
gsub("\\.","",.) %>%
gsub("性","性.",.) %>% data.frame(a=.)
sex.age.variable<-gsub("トマト調味料アイテムランキング","",filename.list) %>%
gsub("_ranking2_","",.) %>%
gsub("xls","",.) %>%
gsub("\\d{7}","",.) %>%
gsub("\\(|\\)","",.) %>%
gsub("\\.","",.) %>%
gsub("性","性.",.) %>% data.frame(a=.) %>% separate(., .$a, c("sex", "age"))
sex.age.variable<-gsub("トマト調味料アイテムランキング","",filename.list) %>%
gsub("_ranking2_","",.) %>%
gsub("xls","",.) %>%
gsub("\\d{7}","",.) %>%
gsub("\\(|\\)","",.) %>%
gsub("\\.","",.) %>%
gsub("性","性.",.) %>% data.frame(a=.) %>% separate(., a, c("sex", "age"))
sex.age.variable <-
separate(sex.age.variable, a, c("sex", "age"))
gsub("トマト調味料アイテムランキング","",filename.list) %>%
gsub("_ranking2_","",.) %>%
gsub("xls","",.) %>%
gsub("\\d{7}","",.) %>%
gsub("\\(|\\)","",.) %>%
gsub("\\.","",.) %>%
gsub("性","性.",.) %>% data.frame(a=.) %>% separate(., a, c("sex", "age"))
file.load <- function(i) {
read_excel(path = filename.list[i],
sheet = "【ﾃｷｽﾄ】",
skip = 0) %>% filter(!is.na(順位))
}
suppressMessages(library(readxl))
suppressMessages(library(dplyr))
suppressMessages(library(tidyverse))
dir(pattern = "ranking")
filename.list <- dir(pattern = "ranking")[-c(7)]
filename.list
sex.age.variable
file.load <- function(i) {
read_excel(path = filename.list[i],
sheet = "【ﾃｷｽﾄ】",
skip = 0) %>% filter(!is.na(順位))
}
file.load(1)
dir()
dir("./購買データ/")
dir("./購買データ/",
pattern = "ranking"
)
dir("./購買データ/", pattern = "ranking")
filename.list <- dir("./購買データ/", pattern = "ranking")[-c(7)]
filename.list
dir("./購買データ/", pattern = "ranking")
filename.list
filename.list
dir("./購買データ/", pattern = "ranking")
dir("./購買データ/", pattern = "ranking", full.names = T)
filename.list <- dir("./購買データ/", pattern = "ranking", full.names = T)[-c(7)]
filename.list
filename.list
sex.age.variable <-
gsub("トマト調味料アイテムランキング", "", filename.list) %>%
gsub("_ranking2_", "", .) %>%
gsub("xls", "", .) %>%
gsub("\\d{7}", "", .) %>%
gsub("\\(|\\)", "", .) %>%
gsub("\\.", "", .) %>%
gsub("性", "性.", .) %>% data.frame(a = .) %>%
separate(., a, c("sex", "age"))
suppressMessages(library(readxl))
suppressMessages(library(dplyr))
suppressMessages(library(tidyverse))
sex.age.variable <-
gsub("トマト調味料アイテムランキング", "", filename.list) %>%
gsub("_ranking2_", "", .) %>%
gsub("xls", "", .) %>%
gsub("\\d{7}", "", .) %>%
gsub("\\(|\\)", "", .) %>%
gsub("\\.", "", .) %>%
gsub("性", "性.", .) %>% data.frame(a = .) %>%
separate(., a, c("sex", "age"))
sex.age.variable
gsub("トマト調味料アイテムランキング", "", filename.list) %>%
gsub("_ranking2_", "", .) %>%
gsub("xls", "", .) %>%
gsub("\\d{7}", "", .) %>%
gsub("\\(|\\)", "", .) %>%
gsub("\\.", "", .) %>%
gsub("性", "性.", .) %>% data.frame(a = .)
gsub("トマト調味料アイテムランキング", "", filename.list) %>%
gsub("_ranking2_", "", .) %>%
gsub("xls", "", .) %>%
gsub("\\d{7}", "", .) %>%
gsub("\\(|\\)", "", .) %>%
gsub("\\.", "", .) %>%
gsub("性", "性.", .)
gsub("トマト調味料アイテムランキング", "", filename.list) %>%
gsub("_ranking2_", "", .) %>%
gsub("xls", "", .) %>%
gsub("\\d{7}", "", .) %>%
gsub("\\(|\\)", "", .) %>%
gsub("\\.", "", .) %>%
gsub("性", "性.", .) %>%
gsub("購買データ", "", .)
gsub("トマト調味料アイテムランキング", "", filename.list) %>%gsub("_ranking2_", "", .) %>%gsub("xls", "", .) %>%gsub("\\d{7}", "", .) %>%gsub("\\(|\\)", "", .) %>%gsub("\\.", "", .) %>%gsub("性", "性.", .) %>% gsub("購買データ", "", .)
gsub("トマト調味料アイテムランキング", "", filename.list) %>%gsub("_ranking2_", "", .) %>%gsub("xls", "", .) %>%gsub("\\d{7}", "", .) %>%gsub("\\(|\\)", "", .) %>%gsub("\\.", "", .) %>%gsub("性", "性.", .) %>% gsub("購買データ", "", .) %>%
gsub("\\\", " ", .)
gsub("トマト調味料アイテムランキング", "", filename.list) %>%gsub("_ranking2_", "", .) %>%gsub("xls", "", .) %>%gsub("\\d{7}", "", .) %>%gsub("\\(|\\)", "", .) %>%gsub("\\.", "", .) %>%gsub("性", "性.", .) %>% gsub("購買データ", "", .) %>%
gsub("\\\", " ", .)
gsub("トマト調味料アイテムランキング", "", filename.list) %>%gsub("_ranking2_", "", .) %>%gsub("xls", "", .) %>%gsub("\\d{7}", "", .) %>%gsub("\\(|\\)", "", .) %>%gsub("\\.", "", .) %>%gsub("性", "性.", .) %>% gsub("購買データ", "", .) %>% gsub( "///", " ",  .)
gsub("トマト調味料アイテムランキング", "", filename.list) %>%gsub("_ranking2_", "", .) %>%gsub("xls", "", .) %>%gsub("\\d{7}", "", .) %>%gsub("\\(|\\)", "", .) %>%gsub("\\.", "", .) %>%gsub("性", "性.", .) %>% gsub("購買データ", "", .) %>% gsub( "///", "",  .)
gsub("トマト調味料アイテムランキング", "", filename.list) %>%gsub("_ranking2_", "", .) %>%gsub("xls", "", .) %>%gsub("\\d{7}", "", .) %>%gsub("\\(|\\)", "", .) %>%gsub("\\.", "", .) %>%gsub("性", "性.", .) %>% gsub("購買データ", "", .) %>% gsub( "///", "",  .)%>% data.frame(a = .)
gsub("トマト調味料アイテムランキング", "", filename.list) %>%gsub("_ranking2_", "", .) %>%gsub("xls", "", .) %>%gsub("\\d{7}", "", .) %>%gsub("\\(|\\)", "", .) %>%gsub("\\.", "", .) %>%gsub("性", "性.", .) %>% gsub("購買データ", "", .) %>% gsub( "///", "",  .)%>% data.frame(a = .) %>%
separate(., a, c("sex", "age"))
se
gsub("トマト調味料アイテムランキング", "", filename.list) %>%gsub("_ranking2_", "", .) %>%gsub("xls", "", .) %>%gsub("\\d{7}", "", .) %>%gsub("\\(|\\)", "", .) %>%gsub("\\.", "", .) %>%gsub("性", "性.", .) %>% gsub("購買データ", "", .) %>% gsub( "///", "",  .)%>% data.frame(a = .) %>%
separate(., a, c("sex", "age"))
sex.age.variable <-gsub("トマト調味料アイテムランキング", "", filename.list) %>%gsub("_ranking2_", "", .) %>%gsub("xls", "", .) %>%gsub("\\d{7}", "", .) %>%gsub("\\(|\\)", "", .) %>%gsub("\\.", "", .) %>%gsub("性", "性.", .) %>% gsub("購買データ", "", .) %>% gsub( "///", "",  .)%>% data.frame(a = .) %>%
separate(., a, c("sex", "age"))
sex.age.variable
filename.list
sex.age.variable <-gsub("トマト調味料アイテムランキング", "", filename.list) %>%gsub("_ranking2_", "", .) %>%gsub("xls", "", .) %>%gsub("\\d{7}", "", .) %>%gsub("\\(|\\)", "", .) %>%gsub("\\.", "", .) %>%gsub("性", "性.", .) %>% gsub("購買データ", "", .) %>% gsub( "///", "",  .)%>% data.frame(a = .) %>%
separate(., a, c("sex", "age"))
filename.list
file.load <- function(i) {
read_excel(path = filename.list[i],
sheet = "【ﾃｷｽﾄ】",
skip = 0) %>% filter(!is.na(順位))
}
file.load(1)
sex.age.variable
map(1:12, .f = file.load)
map(1:12, .f = file.load) %>% tbl_df
map(1:12, .f = file.load)
map_df(1:12, .f = file.load)
file.load(1)
file.load <- function(i) {
read_excel(path = filename.list[i],
sheet = "【ﾃｷｽﾄ】",
skip = 0) %>% filter(!is.na(順位)) %>%
mutate(sex = sex.age.variable$sex[i],
age = sex.age.variable$age[i]) %>% select(age, sex, everything())
}
file.load(1)
file.load(2)
map_df(1:12, .f = file.load)
